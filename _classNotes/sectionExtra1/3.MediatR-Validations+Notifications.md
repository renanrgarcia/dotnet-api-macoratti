# MediatR - Validations

## Validating Commands - MediatR and FluentValidation

- Goal: Validate the commands before processing them.
  - Input validation: null, empty, length, range, etc.
  - Business rules: unique, exists, etc.
- FluentValidation: lambda expressions to define the rules.

## Applying the Validation

- Install the FluentValidation package: `FluentValidation` and `FluentValidation.DependencyInjectionExtensions`
- Create a validator class for the command inheriting from `AbstractValidator<TCommand>`
- Register the validator in the DI container:
  - `services.AddValidatorsFromAssembly(Assembly.Load("CleanArch.Application"));`
- Inject the validator in the command handler and validate the command.

## Alternative: Behaviors

- MediatR behaviors: interceptors for the pipeline.
  - Important to broke the coupling between the validation and the command handler.
  - The validation now works as a middleware, not as a part of the application logic.
- Implement the `ValidationBehavior<TRequest, TResponse>` class inheriting from `IPipelineBehavior<TRequest, TResponse>`
- Define the validation logic in the `Handle` method.
- Register the behavior in the DI container:
  - `services.AddTransient(typeof(IPipelineBehavior<,>), typeof(ValidationBehavior<,>));`
